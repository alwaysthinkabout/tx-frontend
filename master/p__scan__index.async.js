"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[78],{80690:function(x,P,n){n.r(P),n.d(P,{default:function(){return i}});var w=n(25359),l=n.n(w),b=n(49811),m=n.n(b),M=n(54306),v=n.n(M),S=n(61351),u=n(98777),_=n(93236),e=n(62086);function i(){var s=(0,_.useState)([]),c=v()(s,2),a=c[0],f=c[1],d=(0,_.useState)(1),j=v()(d,2),y=j[0],h=j[1],J=(0,_.useState)(0),O=v()(J,2),k=O[0],Z=O[1],H=(0,_.useState)(""),B=v()(H,2),X=B[0],q=B[1],ee=(0,_.useState)(!0),L=v()(ee,2),W=L[0],K=L[1],ne=(0,_.useState)(!1),Q=v()(ne,2),re=Q[0],z=Q[1],se=(0,_.useState)(!1),V=v()(se,2),ce=V[0],de=V[1],ae=(0,_.useState)({Total:100,PageSize:10,PageNum:0}),G=v()(ae,2),_e=G[0],te=G[1],$=function(){var o=m()(l()().mark(function t(g){var D;return l()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,(0,S.zc)({PageSize:10,PageNum:1,Account:g,AccountType:"phone"});case 2:D=p.sent,D.ResponseMetadata.Code===0?(te(D.Result.PageInfo),f(D.Result.List||[])):u.FN.show({content:D.ResponseMetadata.MessageCn});case 4:case"end":return p.stop()}},t)}));return function(g){return o.apply(this,arguments)}}(),Y=function(t){return u.u_.alert({title:"\u9519\u8BEF\u4FE1\u606F",className:"error-info-modal",content:(0,e.jsxs)("div",{className:"error-info-content",children:[(0,e.jsxs)("div",{className:"error-line",children:[(0,e.jsx)("span",{children:"Log ID"}),(0,e.jsx)("span",{children:t==null?void 0:t.id})]}),(0,e.jsxs)("div",{className:"error-line",children:[(0,e.jsx)("span",{children:"\u9519\u8BEF\u4FE1\u606F"}),(0,e.jsx)("span",{children:t==null?void 0:t.errorMsg})]})]}),showCloseButton:!0})},ue=function(t,g){var D=function A(p){return window.wx.scanQRCode({needResult:1,scanType:["qrCode"],success:function(){var N=m()(l()().mark(function E(T){var C,R,U,I;return l()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(console.log("scan res",T),C=T.resultStr,!(C&&typeof C=="string")){r.next=16;break}if(R=C.match(/tkn=(.*)/),!(R&&R[1])){r.next=16;break}return U=R[1],r.prev=6,r.next=9,(0,S.Kf)({TargetUserID:t,QRCodeIDs:[U]});case 9:I=r.sent,I.ResponseMetadata.Code===0?(u.FN.show({content:"\u53D1\u8D27\u6210\u529F"}),p&&p>1&&setTimeout(function(){return A(p-1)},1e3)):Y({id:I.ResponseMetadata.RequestID,errorMsg:I.ResponseMetadata.MessageCn}),r.next=16;break;case 13:r.prev=13,r.t0=r.catch(6),u.FN.show({content:"\u53D1\u8D27\u5931\u8D25"});case 16:case"end":return r.stop()}},E,null,[[6,13]])}));function F(E){return N.apply(this,arguments)}return F}()})};D(g)},oe=function(t,g){var D=function A(p){return window.wx.scanQRCode({needResult:1,scanType:["qrCode"],success:function(){var N=m()(l()().mark(function E(T){var C,R,U,I;return l()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(console.log("scan res",T),C=T.resultStr,!(C&&typeof C=="string")){r.next=16;break}if(R=C.match(/tkn=(.*)/),!(R&&R[1])){r.next=16;break}return U=R[1],r.prev=6,r.next=9,(0,S.Jl)({TargetUserID:t,QRCodeIDs:[U]});case 9:I=r.sent,I.ResponseMetadata.Code===0?(u.FN.show({content:"\u9000\u8D27\u6210\u529F"}),p&&p>1&&setTimeout(function(){return A(p-1)},1e3)):Y({id:I.ResponseMetadata.RequestID,errorMsg:I.ResponseMetadata.MessageCn}),r.next=16;break;case 13:r.prev=13,r.t0=r.catch(6),u.FN.show({content:"\u9000\u8D27\u5931\u8D25"});case 16:case"end":return r.stop()}},E,null,[[6,13]])}));function F(E){return N.apply(this,arguments)}return F}()})};D(g)},le=function(t){Z(t),h(1),K(!0),z(!0)};return(0,e.jsxs)("div",{className:"bg-white p-4 scan-page",children:[(0,e.jsxs)("div",{className:"header",children:[(0,e.jsx)(u.E1,{onChange:function(t){return q(t)},onSearch:$,placeholder:"\u8F93\u5165\u624B\u673A\u53F7\u641C\u7D22",className:"search-bar"}),(0,e.jsx)(u.zx,{onClick:function(){return $(X)},children:"\u641C\u7D22"})]}),(0,e.jsx)(u.aV,{className:"mt-6",children:a.map(function(o){return(0,e.jsx)(u.aV.Item,{children:(0,e.jsxs)("div",{className:"flex justify-between",children:[(0,e.jsx)("div",{children:o.UserName}),(0,e.jsx)("div",{children:o.UserPhone}),(0,e.jsx)(u.zx,{disabled:o==null?void 0:o.IsForbiddenScan,onClick:function(){return le(o.UserID)},children:"\u626B\u8D27"})]})},o.UserID)})}),(0,e.jsx)(u.u_,{visible:re,title:"\u626B\u8D27",showCloseButton:!0,closeOnMaskClick:!0,onClose:function(){return z(!1)},content:(0,e.jsxs)("div",{className:"sao-ma-modal",children:[(0,e.jsx)("div",{className:"title",children:"\u8F93\u5165\u8D27\u7269\u6570\u91CF\uFF0C\u9009\u62E9\u53D1\u8D27\u6216\u9000\u8D27\uFF0C\u70B9\u51FB\u626B\u7801\u3002"}),(0,e.jsxs)("div",{className:"count",children:[(0,e.jsx)("span",{children:"\u8D27\u7269\u6570\u91CF"}),(0,e.jsx)(u.II,{type:"number",value:y?y.toString():"",placeholder:"1 - 13",onChange:function(t){if(!t){h(0);return}var g=Number(t)||0;g<1?h(1):g>13?h(13):h(g)}})]}),(0,e.jsx)("div",{className:"is-delivery",children:(0,e.jsxs)(u.Y8.Group,{value:W?"1":"2",onChange:function(t){return K(t==="1")},children:[(0,e.jsx)(u.Y8,{value:"1",children:"\u53D1\u8D27"}),(0,e.jsx)(u.Y8,{value:"2",children:"\u9000\u8D27"})]})}),(0,e.jsx)(u.zx,{className:"scan-act",color:"primary",onClick:function(){W?ue(k,y):oe(k,y)},children:"\u626B\u7801"})]})})]})}},61351:function(x,P,n){n.d(P,{Jl:function(){return u},Kf:function(){return S},jn:function(){return _},zc:function(){return v}});var w=n(25359),l=n.n(w),b=n(49811),m=n.n(b),M=n(73892),v=function(){var e=m()(l()().mark(function i(s){var c,a,f,d,j;return l()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return c=s.Account,a=s.AccountType,f=s.UserStatus,d=s.PageNum,j=s.PageSize,h.abrupt("return",(0,M.W)("/api/v1/ListVip?Action=ListVip","post",{Account:c,AccountType:a,UserStatus:f,PageNum:d,PageSize:j}));case 2:case"end":return h.stop()}},i)}));return function(s){return e.apply(this,arguments)}}(),S=function(){var e=m()(l()().mark(function i(s){var c,a;return l()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return c=s.TargetUserID,a=s.QRCodeIDs,d.abrupt("return",(0,M.W)("/api/v1/Delivery?Action=Delivery","post",{TargetUserID:c,QRCodeIDs:a}));case 2:case"end":return d.stop()}},i)}));return function(s){return e.apply(this,arguments)}}(),u=function(){var e=m()(l()().mark(function i(s){var c,a;return l()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return c=s.TargetUserID,a=s.QRCodeIDs,d.abrupt("return",(0,M.W)("/api/v1/Return?Action=Return","post",{TargetUserID:c,QRCodeIDs:a}));case 2:case"end":return d.stop()}},i)}));return function(s){return e.apply(this,arguments)}}(),_=function(){var e=m()(l()().mark(function i(s){var c;return l()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return c=s.QRCodeID,f.abrupt("return",(0,M.W)("/api/v1/GetProductDetail?Action=GetProductDetail&QRCodeID=".concat(c),"get"));case 2:case"end":return f.stop()}},i)}));return function(s){return e.apply(this,arguments)}}()},73892:function(x,P,n){n.d(P,{W:function(){return v}});var w=n(25359),l=n.n(w),b=n(49811),m=n.n(b),M=n(24933),v=function(){var S=m()(l()().mark(function u(_,e,i){var s;return l()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,(0,M.Z)({url:_,method:e,data:i});case 3:return s=a.sent,a.abrupt("return",(s==null?void 0:s.data)||{ResponseMetadata:{Code:-1,MessageCn:"\u7F51\u7EDC\u9519\u8BEF\uFF0C\u8BF7\u7A0D\u540E\u91CD\u8BD5"}});case 7:return a.prev=7,a.t0=a.catch(0),console.error(a.t0),a.abrupt("return",{ResponseMetadata:{Code:-1,MessageCn:"\u7F51\u7EDC\u9519\u8BEF\uFF0C\u8BF7\u7A0D\u540E\u91CD\u8BD5"}});case 11:case"end":return a.stop()}},u,null,[[0,7]])}));return function(_,e,i){return S.apply(this,arguments)}}()}}]);
